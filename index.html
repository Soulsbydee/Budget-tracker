<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Budget</title>
    <style>
        * {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

```
    body {
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', system-ui, sans-serif;
        margin: 0;
        padding: 0;
        background: #f2f2f7;
        color: #000;
        line-height: 1.4;
    }
    
    .container {
        max-width: 428px;
        margin: 0 auto;
        min-height: 100vh;
        background: #f2f2f7;
    }
    
    .header {
        background: #f2f2f7;
        padding: 44px 20px 20px;
        border-bottom: 0.5px solid #c6c6c8;
    }
    
    .title {
        font-size: 34px;
        font-weight: 700;
        color: #000;
        margin: 0;
        letter-spacing: -0.41px;
    }
    
    .week-info {
        font-size: 17px;
        color: #8e8e93;
        margin-top: 8px;
        font-weight: 400;
    }
    
    .budget-section {
        background: #fff;
        margin: 20px 16px;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    
    .budget-overview {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 16px;
        margin-bottom: 20px;
    }
    
    .budget-card {
        text-align: center;
        padding: 16px;
        background: #f2f2f7;
        border-radius: 8px;
    }
    
    .budget-amount {
        font-size: 28px;
        font-weight: 600;
        color: #000;
        margin-bottom: 4px;
        letter-spacing: -0.35px;
    }
    
    .budget-label {
        font-size: 13px;
        color: #8e8e93;
        font-weight: 400;
        text-transform: uppercase;
        letter-spacing: 0.06em;
    }
    
    .remaining-card {
        grid-column: 1 / -1;
        text-align: center;
        padding: 20px;
        background: #f2f2f7;
        border-radius: 8px;
    }
    
    .remaining-amount {
        font-size: 32px;
        font-weight: 600;
        color: #34c759;
        margin-bottom: 4px;
        letter-spacing: -0.4px;
    }
    
    .progress-container {
        margin: 20px 0;
    }
    
    .progress-track {
        width: 100%;
        height: 4px;
        background: #e5e5ea;
        border-radius: 2px;
        overflow: hidden;
    }
    
    .progress-fill {
        height: 100%;
        background: #34c759;
        border-radius: 2px;
        transition: width 0.3s ease, background-color 0.3s ease;
    }
    
    .days-section {
        background: #fff;
        margin: 0 16px 20px;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    
    .day-row {
        display: flex;
        align-items: center;
        padding: 16px 20px;
        border-bottom: 0.5px solid #c6c6c8;
        background: #fff;
        transition: background-color 0.15s ease;
        cursor: pointer;
    }
    
    .day-row:last-child {
        border-bottom: none;
    }
    
    .day-row:active {
        background: #f2f2f7;
    }
    
    .day-info {
        flex: 1;
        min-width: 0;
    }
    
    .day-name {
        font-size: 17px;
        font-weight: 400;
        color: #000;
        margin-bottom: 2px;
    }
    
    .day-summary {
        font-size: 15px;
        color: #8e8e93;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    
    .day-amount {
        font-size: 17px;
        font-weight: 600;
        color: #007aff;
        margin-left: 12px;
    }
    
    .chevron {
        margin-left: 8px;
        width: 8px;
        height: 14px;
        opacity: 0.3;
    }
    
    .notes-section {
        background: #fff;
        margin: 0 16px 20px;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    
    .notes-label {
        font-size: 17px;
        font-weight: 600;
        color: #000;
        margin-bottom: 12px;
    }
    
    .notes-input {
        width: 100%;
        min-height: 80px;
        border: none;
        background: #f2f2f7;
        border-radius: 8px;
        padding: 12px;
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
        font-size: 16px;
        color: #000;
        resize: vertical;
        box-sizing: border-box;
    }
    
    .notes-input:focus {
        outline: none;
        background: #e5e5ea;
    }
    
    .notes-input::placeholder {
        color: #8e8e93;
    }
    
    .actions-section {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
        margin: 0 16px 20px;
    }
    
    .action-button {
        background: #007aff;
        color: #fff;
        border: none;
        border-radius: 8px;
        padding: 14px 20px;
        font-size: 17px;
        font-weight: 600;
        cursor: pointer;
        transition: background-color 0.15s ease;
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
    }
    
    .action-button:active {
        background: #0056cc;
    }
    
    .action-button.secondary {
        background: #8e8e93;
    }
    
    .action-button.secondary:active {
        background: #636366;
    }
    
    .history-section {
        margin: 0 16px 40px;
    }
    
    .history-button {
        width: 100%;
        background: #fff;
        border: none;
        border-radius: 12px;
        padding: 16px 20px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        font-size: 17px;
        font-weight: 400;
        color: #007aff;
        cursor: pointer;
        transition: background-color 0.15s ease;
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
    }
    
    .history-button:active {
        background: #f2f2f7;
    }
    
    .history-content {
        display: none;
        margin-top: 16px;
    }
    
    .history-content.visible {
        display: block;
    }
    
    .history-controls {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
        margin-bottom: 16px;
    }
    
    .history-control {
        background: #fff;
        border: none;
        border-radius: 8px;
        padding: 12px 16px;
        font-size: 15px;
        font-weight: 400;
        color: #007aff;
        cursor: pointer;
        transition: background-color 0.15s ease;
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    
    .history-control:active {
        background: #f2f2f7;
    }
    
    .history-control.destructive {
        color: #ff3b30;
    }
    
    .history-item {
        background: #fff;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 12px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    
    .history-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 16px;
    }
    
    .history-week {
        font-size: 17px;
        font-weight: 600;
        color: #000;
    }
    
    .history-date {
        font-size: 13px;
        color: #8e8e93;
    }
    
    .history-stats {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 12px;
        margin-bottom: 16px;
    }
    
    .history-stat {
        text-align: center;
        padding: 12px;
        background: #f2f2f7;
        border-radius: 8px;
    }
    
    .history-stat-value {
        font-size: 20px;
        font-weight: 600;
        color: #000;
        margin-bottom: 2px;
    }
    
    .history-stat-label {
        font-size: 11px;
        color: #8e8e93;
        text-transform: uppercase;
        letter-spacing: 0.06em;
    }
    
    .history-details {
        font-size: 15px;
        color: #8e8e93;
        line-height: 1.4;
        margin-bottom: 12px;
    }
    
    .history-notes {
        background: #f2f2f7;
        padding: 12px;
        border-radius: 8px;
        font-size: 15px;
        color: #000;
        font-style: italic;
    }
    
    /* Modal Styles */
    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.4);
        z-index: 1000;
        backdrop-filter: blur(10px);
    }
    
    .modal-content {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: #fff;
        border-radius: 12px 12px 0 0;
        max-height: 70vh;
        overflow-y: auto;
    }
    
    .modal-header {
        padding: 20px 20px 0;
        border-bottom: 0.5px solid #c6c6c8;
        margin-bottom: 20px;
    }
    
    .modal-title {
        font-size: 20px;
        font-weight: 600;
        color: #000;
        text-align: center;
        margin-bottom: 16px;
    }
    
    .modal-close {
        position: absolute;
        top: 20px;
        right: 20px;
        background: none;
        border: none;
        font-size: 17px;
        color: #007aff;
        cursor: pointer;
        font-weight: 400;
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
    }
    
    .modal-body {
        padding: 0 20px 20px;
    }
    
    .day-total-display {
        text-align: center;
        padding: 20px;
        background: #f2f2f7;
        border-radius: 8px;
        margin-bottom: 20px;
    }
    
    .day-total-amount {
        font-size: 28px;
        font-weight: 600;
        color: #000;
        margin-bottom: 4px;
    }
    
    .day-total-label {
        font-size: 13px;
        color: #8e8e93;
        text-transform: uppercase;
        letter-spacing: 0.06em;
    }
    
    .add-expense-form {
        margin-bottom: 20px;
    }
    
    .form-row {
        display: grid;
        grid-template-columns: 2fr 1fr auto;
        gap: 12px;
        align-items: end;
    }
    
    .input-group {
        display: flex;
        flex-direction: column;
    }
    
    .input-label {
        font-size: 13px;
        color: #8e8e93;
        margin-bottom: 6px;
        font-weight: 400;
        text-transform: uppercase;
        letter-spacing: 0.06em;
    }
    
    .input-field {
        background: #f2f2f7;
        border: none;
        border-radius: 8px;
        padding: 12px;
        font-size: 16px;
        color: #000;
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
    }
    
    .input-field:focus {
        outline: none;
        background: #e5e5ea;
    }
    
    .input-field::placeholder {
        color: #8e8e93;
    }
    
    .add-button {
        background: #007aff;
        color: #fff;
        border: none;
        border-radius: 8px;
        padding: 12px 16px;
        font-size: 15px;
        font-weight: 600;
        cursor: pointer;
        height: 44px;
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
    }
    
    .add-button:active {
        background: #0056cc;
    }
    
    .expenses-list {
        margin-bottom: 20px;
    }
    
    .expense-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 16px;
        background: #f2f2f7;
        border-radius: 8px;
        margin-bottom: 8px;
    }
    
    .expense-desc {
        font-size: 16px;
        color: #000;
        font-weight: 400;
    }
    
    .expense-amount {
        font-size: 16px;
        font-weight: 600;
        color: #007aff;
        margin-right: 12px;
    }
    
    .delete-button {
        background: none;
        border: none;
        color: #ff3b30;
        font-size: 18px;
        width: 24px;
        height: 24px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    @media (max-width: 480px) {
        .form-row {
            grid-template-columns: 1fr;
            gap: 16px;
        }
        
        .add-button {
            width: 100%;
        }
        
        .budget-overview {
            grid-template-columns: 1fr;
        }
        
        .actions-section {
            grid-template-columns: 1fr;
        }
    }
</style>
```

</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">Budget</h1>
            <div class="week-info">Week starting <span id="weekStart"></span></div>
        </div>

```
    <div class="budget-section">
        <div class="budget-overview">
            <div class="budget-card">
                <div class="budget-amount">¬£308</div>
                <div class="budget-label">Weekly Budget</div>
            </div>
            <div class="budget-card">
                <div class="budget-amount" id="totalSpent">¬£0</div>
                <div class="budget-label">Spent So Far</div>
            </div>
        </div>
        
        <div class="remaining-card">
            <div class="remaining-amount" id="remaining">¬£308</div>
            <div class="budget-label">Remaining</div>
        </div>
        
        <div class="progress-container">
            <div class="progress-track">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>
    </div>
    
    <div class="days-section">
        <div class="day-row" onclick="openDayModal('mon', 'Monday')">
            <div class="day-info">
                <div class="day-name">Monday</div>
                <div class="day-summary" id="mon-summary">Tap to add expenses</div>
            </div>
            <div class="day-amount" id="mon-total">¬£0.00</div>
            <svg class="chevron" viewBox="0 0 8 14" fill="currentColor">
                <path d="M1.5 0L0 1.5L5.5 7L0 12.5L1.5 14L8.5 7L1.5 0Z"/>
            </svg>
        </div>
        <div class="day-row" onclick="openDayModal('tue', 'Tuesday')">
            <div class="day-info">
                <div class="day-name">Tuesday</div>
                <div class="day-summary" id="tue-summary">Tap to add expenses</div>
            </div>
            <div class="day-amount" id="tue-total">¬£0.00</div>
            <svg class="chevron" viewBox="0 0 8 14" fill="currentColor">
                <path d="M1.5 0L0 1.5L5.5 7L0 12.5L1.5 14L8.5 7L1.5 0Z"/>
            </svg>
        </div>
        <div class="day-row" onclick="openDayModal('wed', 'Wednesday')">
            <div class="day-info">
                <div class="day-name">Wednesday</div>
                <div class="day-summary" id="wed-summary">Tap to add expenses</div>
            </div>
            <div class="day-amount" id="wed-total">¬£0.00</div>
            <svg class="chevron" viewBox="0 0 8 14" fill="currentColor">
                <path d="M1.5 0L0 1.5L5.5 7L0 12.5L1.5 14L8.5 7L1.5 0Z"/>
            </svg>
        </div>
        <div class="day-row" onclick="openDayModal('thu', 'Thursday')">
            <div class="day-info">
                <div class="day-name">Thursday</div>
                <div class="day-summary" id="thu-summary">Tap to add expenses</div>
            </div>
            <div class="day-amount" id="thu-total">¬£0.00</div>
            <svg class="chevron" viewBox="0 0 8 14" fill="currentColor">
                <path d="M1.5 0L0 1.5L5.5 7L0 12.5L1.5 14L8.5 7L1.5 0Z"/>
            </svg>
        </div>
        <div class="day-row" onclick="openDayModal('fri', 'Friday')">
            <div class="day-info">
                <div class="day-name">Friday</div>
                <div class="day-summary" id="fri-summary">Tap to add expenses</div>
            </div>
            <div class="day-amount" id="fri-total">¬£0.00</div>
            <svg class="chevron" viewBox="0 0 8 14" fill="currentColor">
                <path d="M1.5 0L0 1.5L5.5 7L0 12.5L1.5 14L8.5 7L1.5 0Z"/>
            </svg>
        </div>
        <div class="day-row" onclick="openDayModal('sat', 'Saturday')">
            <div class="day-info">
                <div class="day-name">Saturday</div>
                <div class="day-summary" id="sat-summary">Tap to add expenses</div>
            </div>
            <div class="day-amount" id="sat-total">¬£0.00</div>
            <svg class="chevron" viewBox="0 0 8 14" fill="currentColor">
                <path d="M1.5 0L0 1.5L5.5 7L0 12.5L1.5 14L8.5 7L1.5 0Z"/>
            </svg>
        </div>
        <div class="day-row" onclick="openDayModal('sun', 'Sunday')">
            <div class="day-info">
                <div class="day-name">Sunday</div>
                <div class="day-summary" id="sun-summary">Tap to add expenses</div>
            </div>
            <div class="day-amount" id="sun-total">¬£0.00</div>
            <svg class="chevron" viewBox="0 0 8 14" fill="currentColor">
                <path d="M1.5 0L0 1.5L5.5 7L0 12.5L1.5 14L8.5 7L1.5 0Z"/>
            </svg>
        </div>
    </div>
    
    <div class="notes-section">
        <div class="notes-label">Weekly Notes</div>
        <textarea class="notes-input" id="notes" placeholder="Any observations about your spending this week?"></textarea>
    </div>
    
    <div class="actions-section">
        <button class="action-button secondary" onclick="resetWeek()">New Week</button>
        <button class="action-button" onclick="saveWeek()">Save Week</button>
    </div>
    
    <div class="history-section">
        <button class="history-button" onclick="toggleHistory()">üìä View History</button>
        
        <div class="history-content" id="historyContent">
            <div class="history-controls">
                <button class="history-control" onclick="exportToCSV()">üìÅ Export CSV</button>
                <button class="history-control destructive" onclick="clearHistory()">üóëÔ∏è Clear History</button>
            </div>
            <div id="historyList"></div>
        </div>
    </div>
</div>

<!-- Daily Expense Modal -->
<div id="dayModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-title" id="modalTitle">Monday</div>
            <button class="modal-close" onclick="closeDayModal()">Done</button>
        </div>
        
        <div class="modal-body">
            <div class="day-total-display">
                <div class="day-total-amount" id="modalDayTotal">¬£0.00</div>
                <div class="day-total-label">Total for Day</div>
            </div>
            
            <div class="add-expense-form">
                <div class="form-row">
                    <div class="input-group">
                        <label class="input-label">Description</label>
                        <input type="text" class="input-field" id="itemDesc" placeholder="Coffee, lunch, petrol...">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Amount</label>
                        <input type="number" class="input-field" id="itemAmount" placeholder="0.00" step="0.01" min="0">
                    </div>
                    <button class="add-button" onclick="addItem()">Add</button>
                </div>
            </div>
            
            <div class="expenses-list" id="itemsList"></div>
        </div>
    </div>
</div>

<script>
    const WEEKLY_BUDGET = 308;
    const days = ['mon', 'tue', 'wed', 'thu', 'fri', 'sat', 'sun'];
    let currentDay = '';
    let dailyExpenses = {
        mon: [], tue: [], wed: [], thu: [], fri: [], sat: [], sun: []
    };
    
    // Load data from browser storage
    function loadData() {
        try {
            const saved = localStorage.getItem('budgetTrackerData');
            if (saved) {
                const data = JSON.parse(saved);
                if (data.currentWeek && data.currentWeek.dailyExpenses) {
                    dailyExpenses = data.currentWeek.dailyExpenses;
                    document.getElementById('notes').value = data.currentWeek.notes || '';
                    updateAllDays();
                }
            }
        } catch (error) {
            console.log('Error loading data:', error);
        }
    }
    
    // Save data to browser storage
    function saveData() {
        try {
            const currentWeekData = {
                weekStart: document.getElementById('weekStart').textContent,
                dailyExpenses: dailyExpenses,
                notes: document.getElementById('notes').value,
                timestamp: new Date().toISOString()
            };
            
            const existingData = JSON.parse(localStorage.getItem('budgetTrackerData') || '{"history": []}');
            existingData.currentWeek = currentWeekData;
            localStorage.setItem('budgetTrackerData', JSON.stringify(existingData));
        } catch (error) {
            console.log('Error saving data:', error);
        }
    }
    
    // Set current week start date
    function setWeekStart() {
        const today = new Date();
        const monday = new Date(today);
        monday.setDate(today.getDate() - today.getDay() + 1);
        document.getElementById('weekStart').textContent = monday.toLocaleDateString('en-GB');
    }
    
    // Update day summary and total
    function updateDay(day) {
        const expenses = dailyExpenses[day];
        const total = expenses.reduce((sum, item) => sum + item.amount, 0);
        
        document.getElementById(`${day}-total`).textContent = `¬£${total.toFixed(2)}`;
        
        const summaryEl = document.getElementById(`${day}-summary`);
        if (expenses.length === 0) {
            summaryEl.textContent = 'Tap to add expenses';
            summaryEl.style.color = '#8e8e93';
        } else {
            const itemCount = expenses.length;
            const preview = expenses.slice(0, 2).map(item => item.description).join(', ');
            summaryEl.textContent = itemCount === 1 ? preview : `${preview}${itemCount > 2 ? '...' : ''}`;
            summaryEl.style.color = '#000';
        }
    }
    
    // Update all days and totals
    function updateAllDays() {
        days.forEach(updateDay);
        updateWeeklyTotals();
    }
    
    // Update weekly totals
    function updateWeeklyTotals() {
        let totalSpent = 0;
        days.forEach(day => {
            totalSpent += dailyExpenses[day].reduce((sum, item) => sum + item.amount, 0);
        });
        
        const remaining = WEEKLY_BUDGET - totalSpent;
        const progressPercent = (totalSpent / WEEKLY_BUDGET) * 100;
        
        document.getElementById('totalSpent').textContent = `¬£${totalSpent.toFixed(2)}`;
        document.getElementById('remaining').textContent = `¬£${remaining.toFixed(2)}`;
        document.getElementById('progressFill').style.width = `${Math.min(progressPercent, 100)}%`;
        
        // Update colors based on remaining amount
        const remainingEl = document.getElementById('remaining');
        const progressFill = document.getElementById('progressFill');
        
        if (remaining < 0) {
            remainingEl.style.color = '#ff3b30';
            progressFill.style.background = '#ff3b30';
        } else if (remaining < 50) {
            remainingEl.style.color = '#ff9500';
            progressFill.style.background = '#ff9500';
        } else {
            remainingEl.style.color = '#34c759';
            progressFill.style.background = '#34c759';
        }
        
        saveData();
    }
    
    // Open day modal
    function openDayModal(day, dayName) {
        currentDay = day;
        document.getElementById('modalTitle').textContent = dayName;
        document.getElementById('dayModal').style.display = 'block';
        updateModalContent();
    }
    
    // Close day modal
    function closeDayModal() {
        document.getElementById('dayModal').style.display = 'none';
        document.getElementById('itemDesc').value = '';
        document.getElementById('itemAmount').value = '';
    }
    
    // Update modal content
    function updateModalContent() {
        const expenses = dailyExpenses[currentDay];
        const total = expenses.reduce((sum, item) => sum + item.amount, 0);
        
        document.getElementById('modalDayTotal').textContent
```